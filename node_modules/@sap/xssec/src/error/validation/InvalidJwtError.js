const ValidationError = require("./ValidationError");

class InvalidJwtError extends ValidationError {
    /** @type {Error} Error encountered during parsing */
    #parseError;

    constructor(jwt, parseError, message = `JWT could not be parsed: ${parseError.message}`) {
        super(jwt, message);
        this.name = "InvalidJwtError";
        this.jwt = jwt;
        this.#parseError = parseError;
    }

    get parseError() {
        return this.#parseError;
    }

    set parseError(value) {
        this.#parseError = value;
    }
}

module.exports = InvalidJwtError;