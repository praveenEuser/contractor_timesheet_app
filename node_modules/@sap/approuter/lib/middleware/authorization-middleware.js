'use strict';

const checkAuthorization = require('./authorization-handler');

module.exports = async function authorizationCheck(req, res, next) {

  let authorizationResult = await checkAuthorization (req);
  if (authorizationResult.isAuthorized) {
    next();
  } else {
    let error = new Error(authorizationResult.message);
    error.status = 403;
    next(error);
  }
};
