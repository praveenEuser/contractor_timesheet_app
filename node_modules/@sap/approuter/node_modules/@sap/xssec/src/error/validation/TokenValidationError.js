const debug = require("debug");
const debugLog = debug("xssec");

const ValidationError = require("./ValidationError");

/** @typedef {import("../../token/Token")} Token */

/**
 * Base class for errors thrown when a token fails validation.
 */
class TokenValidationError extends ValidationError {
    /** @type {Token} */
    #token;

    constructor(token, message = "Token is not valid.") {
        super(message);
        this.name = "TokenValidationError";
        this.token = token;

        if(debugLog.enabled) {
            // Logs the JWT string to console if debug is enabled
            this.jwt = token.jwt;
        }
    }

    get token() {
        return this.#token;
    }

    set token(value) {
        this.#token = value;
    }
}

module.exports = TokenValidationError;